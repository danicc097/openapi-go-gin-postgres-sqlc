// Code generated by pregen. DO NOT EDIT.

package rest

import (
  "github.com/danicc097/openapi-go-gin-postgres-sqlc/internal/models"
  "github.com/gin-gonic/gin"
)

func (sh *strictHandlers) authMiddlewares(opID OperationID) []gin.HandlerFunc {
	return authMiddlewares(opID, sh.h)
}

func (h *Handlers) authMiddlewares(opID OperationID) []gin.HandlerFunc {
	return authMiddlewares(opID, h)
}

func authMiddlewares(opID OperationID, h *Handlers) []gin.HandlerFunc {
  switch opID {
  {{- range $opID, $authInfo := .Operations}}
  case {{ $opID }}:
    return []gin.HandlerFunc{
      {{- if $authInfo.RequiresAuthentication }}
      h.authmw.EnsureAuthenticated(),
      {{- end }}
      {{- if or ($authInfo.Scopes) ($authInfo.Role) }}
      h.authmw.EnsureAuthorized(
        AuthRestriction{
        {{- if $authInfo.Role }}
        MinimumRole: models.Role("{{$authInfo.Role}}"),
        {{- end }}
        {{- if $authInfo.Scopes }}
        RequiredScopes: models.Scopes{
          {{ stringsJoinSlice $authInfo.Scopes "models.Scope(\"" "\")" ",\n" -}}
        },
        {{- end }}
      }),
      {{- end }}
    }
  {{- end }}
  default:
    return []gin.HandlerFunc{}
  }
}
